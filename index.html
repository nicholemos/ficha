<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ficha Tormenta 20 - JdA</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>

<body class="bg-dark py-4">

    <div class="container sheet bg-white p-4 rounded shadow-lg">

        <header class="mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3 pb-2 border-bottom">
                <span class="fw-bold text-danger fst-italic fs-4">Ficha T20 Digital</span>

                <div>
                    <button class="btn btn-outline-secondary btn-sm me-1" onclick="exportSheet()"
                        title="Salvar backup no computador">
                        <i class="bi bi-download"></i> Baixar Ficha
                    </button>

                    <button class="btn btn-outline-secondary btn-sm"
                        onclick="document.getElementById('fileInput').click()" title="Carregar backup">
                        <i class="bi bi-upload"></i> Carregar Ficha
                    </button>

                    <input type="file" id="fileInput" style="display: none;" accept=".json"
                        onchange="importSheet(this)">
                </div>
            </div>
            <div class="row g-2 mb-2 align-items-end">
                <div class="col-md-6">
                    <label class="t20-label">Personagem</label>
                    <input type="text" class="form-control t20-input" id="charName">
                </div>
                <div class="col-md-5">
                    <label class="t20-label">Jogador(a)</label>
                    <input type="text" class="form-control t20-input" id="playerName">
                </div>
                <div class="col-md-1 text-center">
                    <span class="fw-bold text-danger fst-italic fs-4">T20</span>
                </div>
            </div>

            <div class="row g-2">
                <div class="col-md-3">
                    <label class="t20-label">Raça</label>
                    <input type="text" class="form-control t20-input" id="charRace">
                </div>
                <div class="col-md-3">
                    <label class="t20-label">Origem</label>
                    <input type="text" class="form-control t20-input" id="charOrigin">
                </div>
                <div class="col-md-3">
                    <label class="t20-label">Classe(s)</label>
                    <input type="text" class="form-control t20-input" id="charClass">
                </div>
                <div class="col-md-1">
                    <label class="t20-label">Nível</label>
                    <input type="number" class="form-control t20-input text-center" id="charLevel" value="1" min="1"
                        max="20">
                </div>
                <div class="col-md-2">
                    <label class="t20-label">Divindade</label>
                    <input type="text" class="form-control t20-input" id="charDeity">
                </div>
            </div>
        </header>

        <div class="row">
            <div class="col-lg-8">

                <div class="row mb-4 text-center g-1" id="attributesArea">
                </div>

                <div class="row mb-4">
                    <div class="col-6">
                        <div class="border border-2 border-dark rounded p-2 position-relative pt-3">
                            <span class="t20-status-label">PONTOS DE VIDA</span>
                            <div class="d-flex gap-2">
                                <input type="number"
                                    class="form-control border-0 border-bottom text-center fw-bold fs-5"
                                    placeholder="Máx" id="pvMax">
                                <input type="number"
                                    class="form-control border-0 border-bottom text-center fw-bold fs-5"
                                    placeholder="Atual" id="pvCurrent">
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="border border-2 border-dark rounded p-2 position-relative pt-3">
                            <span class="t20-status-label">PONTOS DE MANA</span>
                            <div class="d-flex gap-2">
                                <input type="number"
                                    class="form-control border-0 border-bottom text-center fw-bold fs-5"
                                    placeholder="Máx" id="pmMax">
                                <input type="number"
                                    class="form-control border-0 border-bottom text-center fw-bold fs-5"
                                    placeholder="Atual" id="pmCurrent">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="border border-2 border-dark rounded p-3 mb-4 position-relative bg-white">
                    <span class="t20-section-title">ATAQUES</span>

                    <div class="row fw-bold small text-center border-bottom border-dark pb-2 mb-2">
                        <div class="col-1"><i class="bi bi-dice-20"></i></div>
                        <div class="col-5">ATAQUE</div>
                        <div class="col-2">BÔNUS</div>
                        <div class="col-2">DANO</div>
                        <div class="col-2">CRÍTICO</div>
                    </div>

                    <div id="attacksList" class="mb-3">
                    </div>

                    <button class="btn btn-dark w-100 fw-bold" onclick="addAttack()">
                        <i class="bi bi-plus-lg"></i> ADICIONAR ATAQUE
                    </button>
                </div>

                <div class="border border-2 border-dark rounded p-3 position-relative bg-white">
                    <span class="t20-section-title">DEFESA</span>

                    <div
                        class="d-flex align-items-center justify-content-center gap-2 mb-3 border-bottom border-dark pb-3">

                        <div class="def-shield d-flex align-items-center justify-content-center fs-1 fw-bold shadow-sm">
                            <span id="defenseTotal">10</span>
                        </div>

                        <div class="d-flex align-items-center flex-wrap gap-2 fw-bold small">
                            <span class="fs-4 text-muted">= 10 + </span>

                            <div class="text-center position-relative">
                                <div class="d-flex align-items-center justify-content-center mb-1">
                                    <input type="checkbox" class="form-check-input border-dark me-1" id="applyDefAttr"
                                        checked title="Somar?" onchange="updateCalculations(); saveData()">
                                    <span id="defAttrVal" class="fs-5 text-danger">0</span>
                                </div>
                                <select class="form-select text-center p-0 ps-2" style="width: 70px; height: 35px;"
                                    id="defAttrSelect" onchange="updateCalculations(); saveData()">
                                    <option value="DES">DES</option>
                                    <option value="CON">CON</option>
                                    <option value="SAB">SAB</option>
                                    <option value="INT">INT</option>
                                    <option value="CAR">CAR</option>
                                    <option value="FOR">FOR</option>
                                </select>
                            </div>

                            <span class="fs-4 text-muted">+</span>

                            <div class="text-center opacity-75">
                                <span id="dispArmorBonus" class="fs-5">0</span><br><small>ARM</small>
                            </div>

                            <span class="fs-4 text-muted">+</span>

                            <div class="text-center opacity-75">
                                <span id="dispShieldBonus" class="fs-5">0</span><br><small>ESC</small>
                            </div>

                            <span class="fs-4 text-muted">+</span>

                            <div class="text-center opacity-75">
                                <span id="dispOtherBonus" class="fs-5">0</span><br><small>OUT</small>
                            </div>
                        </div>
                    </div>

                    <div class="fixed-slot armor rounded p-2 mb-2">
                        <div class="row g-1 align-items-end">
                            <div class="col-1 text-center fs-4 mb-1"><i class="bi bi-shield-shaded text-danger"></i>
                            </div>
                            <div class="col-5">
                                <label class="def-label-mini text-start ps-1">NOME DO ITEM</label>
                                <input type="text" class="form-control fw-bold" id="armorName"
                                    placeholder="Armadura (Nenhuma)" oninput="saveData()">
                            </div>
                            <div class="col-2">
                                <label class="def-label-mini text-success">DEFESA</label>
                                <input type="number" class="form-control text-center fw-bold text-success"
                                    id="armorBonus" placeholder="+0" oninput="updateCalculations(); saveData()">
                            </div>
                            <div class="col-2">
                                <label class="def-label-mini text-danger">PENAL.</label>
                                <input type="number" class="form-control text-center text-danger" id="armorPenalty"
                                    placeholder="0" title="Penalidade de Armadura"
                                    oninput="updateCalculations(); saveData()">
                            </div>
                            <div class="col-2">
                                <button class="btn btn-sm btn-outline-secondary w-100 mb-1"
                                    onclick="toggleFixedDetail('armorDetail')"><i
                                        class="bi bi-chevron-down"></i></button>
                            </div>
                        </div>
                        <div id="armorDetail" class="mt-2 d-none border-top pt-2">
                            <div class="row g-2">
                                <div class="col-6">
                                    <label class="form-label-sm">CATEGORIA</label>
                                    <select class="form-select form-select-sm" id="armorType"
                                        onchange="checkHeavyArmor(); saveData()">
                                        <option value="light">Leve</option>
                                        <option value="heavy">Pesada</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <label class="form-label-sm">DESCRIÇÃO</label>
                                    <input type="text" class="form-control form-control-sm" id="armorDesc"
                                        placeholder="Ex: Reforçada" oninput="saveData()">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="fixed-slot shield rounded p-2 mb-2">
                        <div class="row g-1 align-items-end">
                            <div class="col-1 text-center fs-4 mb-1"><i class="bi bi-shield-fill text-primary"></i>
                            </div>
                            <div class="col-5">
                                <label class="def-label-mini text-start ps-1">NOME DO ITEM</label>
                                <input type="text" class="form-control fw-bold" id="shieldName"
                                    placeholder="Escudo (Nenhum)" oninput="saveData()">
                            </div>
                            <div class="col-2">
                                <label class="def-label-mini text-success">DEFESA</label>
                                <input type="number" class="form-control text-center fw-bold text-success"
                                    id="shieldBonus" placeholder="+0" oninput="updateCalculations(); saveData()">
                            </div>
                            <div class="col-2">
                                <label class="def-label-mini text-danger">PENAL.</label>
                                <input type="number" class="form-control text-center text-danger" id="shieldPenalty"
                                    placeholder="0" title="Penalidade de Armadura"
                                    oninput="updateCalculations(); saveData()">
                            </div>
                            <div class="col-2">
                                <button class="btn btn-sm btn-outline-secondary w-100 mb-1"
                                    onclick="toggleFixedDetail('shieldDetail')"><i
                                        class="bi bi-chevron-down"></i></button>
                            </div>
                        </div>
                        <div id="shieldDetail" class="mt-2 d-none border-top pt-2">
                            <div class="row g-2">
                                <div class="col-6">
                                    <label class="form-label-sm">TIPO</label>
                                    <select class="form-select form-select-sm" id="shieldType" onchange="saveData()">
                                        <option value="light">Leve</option>
                                        <option value="heavy">Pesado</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <label class="form-label-sm">DESCRIÇÃO</label>
                                    <input type="text" class="form-control form-control-sm" id="shieldDesc"
                                        placeholder="Ex: Aço" oninput="saveData()">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="border-top border-dark mt-3 pt-2">
                        <h6 class="small fw-bold text-muted text-center mb-2">OUTROS MODIFICADORES</h6>
                        <div id="defenseList" class="mb-2">
                        </div>
                        <button class="btn btn-outline-dark w-100 fw-bold btn-sm" onclick="addDefenseItem()">
                            <i class="bi bi-plus-circle"></i> Adicionar Outro Modificador
                        </button>
                    </div>

                </div>
                <div class="row mb-4">
                    <div class="col-12 mb-3">
                        <div class="border border-2 border-dark rounded p-2 position-relative pt-3 h-100 bg-white">
                            <span class="t20-section-title">PROFICIÊNCIAS & OUTRAS CARACTERÍSTICAS</span>
                            <textarea class="form-control border-0" id="charProfs" rows="5"
                                placeholder="Escreva suas proficiências e habilidades de raça/classe aqui..."
                                oninput="saveData()"></textarea>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="border border-2 border-dark rounded p-2 position-relative pt-3 bg-white">
                            <span class="t20-status-label">TAMANHO</span>
                            <select class="form-select border-0 fw-bold text-center" id="charSize"
                                onchange="updateCalculations(); saveData()">
                                <option value="0">Médio</option>
                                <option value="2">Pequeno (+2 Furt)</option>
                                <option value="5">Minúsculo (+5 Furt)</option>
                                <option value="-2">Grande (-2 Furt)</option>
                                <option value="-5">Enorme (-5 Furt)</option>
                                <option value="-10">Colossal (-10 Furt)</option>
                            </select>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="border border-2 border-dark rounded p-2 position-relative pt-3 bg-white">
                            <span class="t20-status-label">DESLOCAMENTO</span>
                            <input type="text" class="form-control border-0 text-center fw-bold" id="charSpeed"
                                placeholder="9m" oninput="saveData()">
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="border border-2 border-dark rounded p-2 position-relative pt-3 bg-white">
                            <span class="t20-status-label">EXPERIÊNCIA (XP)</span>
                            <input type="number" class="form-control border-0 text-center fw-bold" id="charXP"
                                placeholder="0" oninput="saveData()">
                        </div>
                    </div>
                </div>

            </div>


            <div class="col-lg-4">
                <div class="border border-2 border-dark h-100 bg-light">
                    <div class="bg-danger text-white text-center fw-bold py-1">PERÍCIAS</div>

                    <div class="row g-0 text-center small fw-bold border-bottom border-dark mx-1">
                        <div class="col-1">T</div>
                        <div class="col-4 text-start ps-1">Nome</div>
                        <div class="col-2 text-danger">Tot</div>
                        <div class="col-1 text-muted">=</div>
                        <div class="col-1 text-muted">nv</div>
                        <div class="col-1 text-muted">at</div>
                        <div class="col-1 text-muted">tr</div>
                        <div class="col-1 text-muted">ou</div>
                    </div>

                    <div id="skillsList" class="p-1 small" style="max-height: 800px; overflow-y: auto;">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>